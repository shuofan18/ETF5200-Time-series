---
title: "ETF5200 Applied time series econometrics"
subtitle: "Project 2"
author: "Shuofan Zhang 27886913"
bibliography: reference.bib
date: ''
fontsize: 12pt
output: 
  pdf_document: 
    latex_engine: xelatex
link-citations: yes
delete_merged_file: yes
biblio-style: apalike
toc: yes
---

# Part I

Personal capita consumption and income data are more likely to be inter-dependent dynamically, therefore vector autoregressive model (VAR) will be used to study their behavior in this project. By looking at the data summary, we can see we have 251 observations, there are no missing values. The period of this data set is from the first quarter 1947 to the third quarter 2009.

## Question 1

We start with checking the time plots of these two series, which are shown in figure 1. We can see the increasing time trend clearly. The VAR model needs to be stationary. We first difference the series. The graph after first difference is shown in figure 2, we can see the first-differenced series are stationary. Hence the interested model form is as below:

$$\Delta Y_t=A_0 + A_1 \Delta Y_{t-1} + A_2 \Delta Y_{t-2} + \epsilon_t$$
where 
$$
\Delta Y_t=\begin{pmatrix}
  \Delta Consumption_t \\
  \Delta Income_t
 \end{pmatrix} \ \ 
 
 \epsilon_t=\begin{pmatrix}
  \epsilon_{1t} \\
  \epsilon_{2t}
 \end{pmatrix}
$$
and $A_0$, $A_1$, $A_2$ are coefficient matrices.
First we want to estimate the intercept vector ($A_0$) and the coefficient matrices ($A_1$ and $A_2$) for the VAR(2) model. 

```{r fig1, echo=FALSE, fig.cap="Time plots of personal capita consumption and income shows clear trend.", message=FALSE, warning=FALSE, paged.print=FALSE}
setwd("/Users/stanza/documents/github/etf5200-time-series")
library(readxl)
library(tidyverse)
library(reshape2)
tsdata <- read_excel("USdata2.xls", sheet = 1, range = "A1:B252") %>% ts(start=c(1947,1), frequency = 4) %>% melt(id="time")
ggplot(tsdata,aes(x=Var1,y=value,colour=Var2,group=Var2))+geom_line()+theme(axis.text.x=element_blank(),axis.text.y=element_blank())+xlab("time")+ylab("level series")+labs(colour = "Variables")
```

```{r fig2, echo=FALSE, fig.cap="Time plots of first-differenced personal capita consumption and first-differenced income.", message=FALSE, warning=FALSE, paged.print=FALSE}
dfdata <- read_excel("USdata2.xls", sheet = 1, range = "A1:B252") %>% ts(start=c(1947,1), frequency = 4)
dfdata <- diff(dfdata) %>% melt(id="time")
ggplot(dfdata,aes(x=Var1,y=value,colour=Var2,group=Var2))+geom_line()+theme(axis.text.x=element_blank(),axis.text.y=element_blank())+xlab("time")+ylab("First-differenced series")+labs(colour = "Variables")+facet_grid(. ~ Var2)
```


```{r var, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}
library(tsDyn)
library(mvtnorm)
library(vars)
library(knitr)
biv <- read_excel("USdata2.xls", sheet = 1, range = "A1:B252") %>% ts(start=c(1947,1), frequency = 4)
dfbiv <- diff(biv) 
model <- VAR(dfbiv, p=2, type="const")
Acm = Acoef(model)
A1 <- Acm[[1]]
A2 <- Acm[[2]]
kable(A1, col.names = c("Consumption lag 1", "Income lag 1"), caption = "Coefficient matrix A1")
kable(A2, col.names = c("Consumption lag 2", "Income lag 2"), caption = "Coefficient matrix A2")
A0 <- matrix(c(0.044288507, 0.001650857), ncol=1)
A0 <- cbind(c("Consumption", "Income"), A0)
kable(A0, col.names = "Intercept", caption = "Intercept matrix")
```

## Question 2

AIC and HQ choose lag of order 4 while BIC chooses 3. Since AIC tends to over-estimate and BIC tends to under-estimate, HQ also chooses 4 lags, we will consider 4 lags as the correct order p in this case.

```{r ic, echo=F, results='asis'}
AIC <- VAR(biv_data, lag.max = 10, ic="AIC", type = "both") %>% .$p
BIC <- VAR(biv_data, lag.max = 10, ic="SC", type = "both") %>% .$p
HQ <- VAR(biv_data, lag.max = 10, ic="HQ", type = "both") %>% .$p
IC <- c(AIC, BIC, HQ)
kable(IC, col.names = "Lags chosen by Information Criteria", caption = "AIC and HQ choose lag of order 4 while BIC chooses 3.")
```

# Part II

## The main ideas proposed

In 1981, Granger first introduced the idea of co-integration in @G1981 without giving any estimation methods. He believed that "the practice of data-mine should be brought out into the open" and this co-integration idea was "potentially very important". He was curious about if prices and wages were co-integrated or not, and he suggested appropriate investigation was needed to find out which pairs of economic variables are co-integrated. [@G1981] In 1983, Granger and Weiss did further study on this topic, some error-correction model forms and testing methods were discussed, three applications were conducted which including employees' income and national income; M3 and GNP; prices, wages and productivity. However the results in the three applications in that paper were all unsatisfactory indicating the model structure may not be appropraite. [@G1983]

Therefore, in 1987, Engle and Granger wrote this paper [@E1987] to formally define the conception error-correcting models and co-integration. Properties and co-integration varibles and their representations, estimating and testing methods were also established.

## The main techniques used

## The main data used

Four examples were given to show the performance of the tests introduced in this paper. 

- The relationship between consumption and income in U.S.
The U.S. quarterly real per capita consumption on nondurables and real per capita disposable income from 1947-I to 1981-II.

- Monthly wages and prices in U.S.
Logs of the consumer price index and production worker wage in manufacturing over the three decades of 50's, 60's, and 70's. For each of the decades there are 120 observations.

- Short and long term interest rates in U.S.
Monthly yields to maturity of 20 years treasury bonds (long term rate $R_t$) and the one month treasury bill rate (short rate $r_t$) from February, 1952 to December, 1982.

## The main results obtained

## The conclusion made

## My own models and proposals





